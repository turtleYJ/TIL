## 3장

### 3.2 요청 메서드

- **GET** : 리소스 상태의 표현
- **HEAD** : 리소스 상태에 대한 메타데이터를 얻을 때 사용
- **PUT** : 새로운 리소스를 스토어에 추가하거나 기존 리소스를 갱신할 때 사용
- **DELETE** : 모부에서 리소스를 제거할 때 사용
- **POST** : 컬렉션에 새로운 리소스를 만들거나 컨트롤러를 실행할 때 사용

#### 규칙

1. **GET 메서드나 POST 메서드를 사용하여 다른 요청 메서드를 처리해서는 안 된다.**
    - 터널링(tunneling)은 메시지의 원래 의도를 감추거나 잘못 표현하는 것인데 터널링을 일으키면 안 된다.
2. **GET 메서드는 리소스의 상태 표현을 얻는 데 사용해야 한다.**
3. **응답 헤더(Request Header)를 가져올 때는 반드시 HEAD 메서드를 사용해야 한다.**
    - 클라이언트는 HEAD 메서드를 사용하여 헤더 정보만 가져온다.
    - HEAD 메서드는 GET 메서드와 동일한 응답을 주지만, 바디가 없다.
    - 클라이언트는 HEAD 메서드로 리소스 존재 여부를 확인 하거나, 메타데이터를 읽는다.
4. **PUT 메서드는 리소스를 삽입하거나 저장된 리소스를 갱신하는 데 사용해야 한다.**
    - PUT 요청 메세지에는 클라이언트에서 저장하려는 리소스를 표현하는 부분이 포함되어야 한다.
5. **PUT 메서드는 변경 가능한 리소스를 갱신하는 데 사용해야 한다.**
6. **POST 메서드는 컬렉션에 새로운 리소스를 만드는 데 사용해야 한다.**
    - 예) POST /leagues/seattle/teams/trebuchet/players
        - 해당 요청을 통해 플레이어를 추가할 수 있다. 이 요청에는 플레이어의 초기 상태 데이터를 포함해야 한다.
7. **POST 메서드는 컨트롤러를 실행하는 데 사용해야 한다.**
    - 예) POST /alerts/245743/resend
        - 이 요청에서는 POST 메서드를 사용해서 기능 지향적일 컨트롤러 리소스를 동작시킨다.
    - POST 메서드는 두 가지 사용 법이 있다
        1. 컬렉션에 새로운 리소스를 만듬
        2. 특정 컨트롤러를 동작 시킴
8. **DELETE 메서드는 그 부모에서 리소스를 삭제하는 데 사용해야 한다.**
    - 반드시 리소스를 삭제할 때만 사용하는 명확한 의미이다.
    - 만약, 어떤 API에서 리소스를 완전히 지우지 않고 임시 삭제 기능을 제공하거나 상태만 바꾸는 기능을 제공하려면, 특별한 컨트롤러 리소스를 채택하고 DELETE메서드 대신 POST 메서드를 사용해야 한다.
    - **개인적 견해 :  위 규칙은 그러하나, soft-delete인지 hard-delete인지 클라이언트 입장에서 알 방법이 없다. 따라서 조직 구성원들과의 협의를 통해 메서드를 결정하는 것이 더 좋을 것으로 생각된다.**
9. **OPTIONS 메서드는 리소스의 사용 가능한 인터랙션을 기술한 메타데이터를 가져오는 데 사용해야 한다.**
    - 클라이언트가 서버에 어떤 메서드와 헤더를 지원하는지 물어보기 위해 사용
    - CORS와 관련하여 사용된다. - Cross-Origin 요청 시, 클라이언트가 실제 요청을 보내기 전에 안전한지 여부를 확인하기 위해 “프리플라이트(pre-flight)”요청을 보내는 경우가 있다.
    - 프리플라이트(pre-flight)란 실제 요청을 보내기 전에 보내는 요청으로, 실제 요청이 서버에 의해 수락될 수 있는지를 확인하기 위한 것이다.

### 3.3 응답 상태 코드

#### 2xx - 성공

- **200(”OK”)** - 응답 바디 포함
- **201(”Created”)** - 성공적으로 리소스 생성
- **202(”Accepted”)** - 비동기 처리 성공
  - 클라이언트의 요청이 비동기적으로 처리될 것임을 나타냄
  - 최종적으로 처리되기까지는 문제가 생길 수도 있다는 것을 클라이언트에게 알림(비동기이기 때문에)
  - 보통 처리 시간이 오래 걸리는 응답에 사용된다.
- **204(”No Content”)** - 응답 바디에 의도적으로 아무것도 포함하지 않을 때 사용
  - 응답 바디에 아무것도 표현할 필요가 없을 때(보통 POST, PUT, DELETE)

#### 3xx - 재전송 (클라이언트는 요청을 완료하기 위해 추가적인 행동을 취해야 함)

- **301(”Movded Permanently”)** - 리소스를 이동시켰을 때 사용
- **303(”See Other”)** - 다른 URI를 참조하라고 알려줄 때
- **304(”Not Modified”)** - 대역폭을 절약할 때
  - 응답 바디에 아무것도 없는 점에서 204와 비슷 하나, 304는 리소스에 대한 상태 정보가 있지만 (바뀐 것이 없어) 클라이언트가 이미 해당 상태를 가지고 있는 경우에 사용한다.
- **307(”Temporary Redirect”)** - 클라이언트가 다른 URI로 요청을 다시 보내게 할 때 사용해야 한다.
  - 307 응답은 REST API가 클라이언트의 요청을 처리하지 않을 것임을 나타낸다.
  - 클라이언트는 응답 메세지의 Location 헤더에 기술된 URI로 요청을 다시 보내야 한다.

#### 4xx - 클라이언트 오류 (클라이언트의 잘못된 요청)

- **400(”Bad Request”)** - 일반적인 요청 실패
  - 일반적인 클라이언트 오류
- **401(”Unauthorized”)** - 클라이언트 인증에 문제가 있을 때 사용
- **403(”Forbidden”)** - 인증 상태에 솽관없이 액세스를 금지할 때 사용
  - 클라이언트의 요청은 문제없음
  - REST API가 요청에 응하지 않은 경우
- **404(”NOT Found”)** - URI에 해당하는 리소스가 없을 때
- **405(”Method Not Allowed”)** - 지원하지 않는 HTTP메서드를 사용할 때 발생
- **406(”Not Acceptable”)** - 요청된 리소스 미디어 타입(MIME)을 제공하지 못할 때 사용한다.
  - 클라이언트가 ‘Accept’ 헤더를 사용하여 특정 MIME타입을 요청하였는데, 서버가 그런 형식을 제공할 수 없는 경우 발생.
- **409(”Conflict”)** - 리소스 상태에 위반되는 행위를 했을 때 사용
  - 예) 클라이언트가 비어 있지 않은 스토어 리소스를 삭제하라고 요청하는 경우
- **412(”Precondition Failed”)** - 조건부 연산을 지원할 때 사용
  - 클라이언트가 요청 헤더에 하나 이상의 전제 조건(Precondition)을 지정했는데 이를 만족하지 못할 때 발생한다.
- **415(”Unsupported Media Type”)** - 페이로드에 있는 미디어 타입이 처리되지 못했을 때 사용한다.
  - 클라이언트가 서버에게 특정한 미디어 타입을 사용할 것임을 나타내는데, 서버가 해당 미디어 타입을 처리할 수 없는 경우에 발생
  - 주로 POST 또는 PUT 요청에서 클라이언트가 서버에게 전송한 데이터의 미디어 타입이 서버가 지원하지 않을 때 발생.

#### 5xx - 서버 오류 (서버쪽 오류로 인한 상태 코드)

- **500(”Internal Server Error”)** - API가 잘못 작동할 때 사용해야 한다